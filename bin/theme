#!/bin/bash

set -e

read -p "Please enter your new WordPress theme name: " ORIGINAL

KEBABCASE=`echo "${ORIGINAL}" | tr " " -`
SNAKECASE=`echo "${ORIGINAL}" | tr " " _`
LOWERCASE=`echo "${KEBABCASE}" | tr '[A-Z]' '[a-z]'`
UPPERCASE=`echo "${SNAKECASE}" | tr '[a-z]' '[A-Z]'`
TITLECASE=`echo "${KEBABCASE}" | tr '-' '\n' | awk '{printf "%s%s", toupper(substr($0,0,1)), substr($0,2)}'`

echo ""

replace_theme_name() {
  eval `sed -i '' "s/Skela/${ORIGINAL}/" .env`
  eval `sed -i '' "s/Skela/${ORIGINAL}/" .env.sample`
  eval `sed -i '' "s/Skela/${ORIGINAL}/" docker-compose.yml`
  eval `sed -i '' "s/Skela/${ORIGINAL}/" MULTISITE.md`
  eval `sed -i '' "s/Skela/${ORIGINAL}/" README.md`
  eval `sed -i '' "s/Skela/${ORIGINAL}/" style.css`
}

replace_titlecase() {
  eval `sed -i '' "s/Skela/${TITLECASE}/" composer.json`
  eval `sed -i '' "s/Skela/${TITLECASE}/" front-page.php`
  eval `sed -i '' "s/Skela/${TITLECASE}/" functions.php`
  eval `sed -i '' "s/Skela/${TITLECASE}/" index.php`
  eval `sed -i '' "s/Skela/${TITLECASE}/" src/**/*.php`
}

replace_lowercase() {
  eval `sed -i '' "s/skela/${LOWERCASE}/" .env`
  eval `sed -i '' "s/skela/${LOWERCASE}/" .env.sample`
  eval `sed -i '' "s/skela.ups.dock/${LOWERCASE}.ups.dock/" composer.json`
  eval `sed -i '' "s/skela.ups.dock/${LOWERCASE}.ups.dock/" composer.lock`
  eval `sed -i '' "s/skela.ups.dock/${LOWERCASE}.ups.dock/" docker-compose.yml`
  eval `sed -i '' "s/skela/${LOWERCASE}/" MULTISITE.md`
  eval `sed -i '' "s/skela/${LOWERCASE}/" package-lock.json`
  eval `sed -i '' "s/skela/${LOWERCASE}/" package.json`
  eval `sed -i '' "s/skela.ups.dock/${LOWERCASE}.ups.dock/" package.json`
  eval `sed -i '' "s/#skela/#${LOWERCASE}/" README.md`
  eval `sed -i '' "s/skela.ups.dock/${LOWERCASE}.ups.dock/" README.md`
  eval `sed -i '' "s/skela.ups.dock/${LOWERCASE}.ups.dock/" webpack.config.js`
  eval `sed -i '' "s/skela/${LOWERCASE}/" bin/composer`
  eval `sed -i '' "s/skela/${LOWERCASE}/" src/Blocks/SampleBlock/sample-block.js`
  eval `sed -i '' "s/skela/${LOWERCASE}/" src/Managers/ThemeManager.php`
}

replace_uppercase() {
  eval `sed -i '' "s/SKELA/${UPPERCASE}/" functions.php`
  eval `sed -i '' "s/SKELA/${UPPERCASE}/" src/**/*.php`
}


echo "Replacing theme name"
replace_theme_name

echo "Replacing 'Skela' with '$TITLECASE'"
replace_titlecase

echo "Replacing 'skela' with '$LOWERCASE'"
replace_lowercase

echo "Replacing 'SKELA' with '$UPPERCASE'"
replace_uppercase
